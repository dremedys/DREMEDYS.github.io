<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LFSR</title>
    <style>
        body{
            padding: 100px;
        }
        button:hover{
            cursor: pointer;
        }
        textarea{
            display: block;
            width: 300px;
            height: 150px;
            margin-bottom: 10px;
        }
        #answer{
            position: absolute;
            top:30px;
            left: 380px;
            color: gray;
            font-family: Bahnschrift;

        }
    </style>
</head>
<body>
    <label>Your task</label>
    <input id="missed">
    <div></div>
    <input placeholder="register length" id="register">
    <button id="btn">Get answer</button>
    <div id="answer"></div>
<script>
    function generateBinary(n){
        let states = [];
        let maxDecimal = parseInt("1".repeat(n),2);
        for(let i = 0; i <= maxDecimal; i++){
            states.push(i.toString(2).padStart(n,'0'));
        }
        return states;
    }
    function checkOneRow(x,ans,Y){
        let onesInRow = []
        for(let i =0;i<x.length;i++){
            if(parseInt(x[i])){
                onesInRow.push(i)
            }
        }
        let s = parseInt(ans[onesInRow.pop()])
        for(let i = 0 ;i< onesInRow.length;i++){
            s = s ^ parseInt(ans[onesInRow[i]])
        }
        return s == Y
    }
    function isRight(com,matrix,Y){
        for(let i = 0; i< matrix.length;i++){
            if(!checkOneRow(matrix[i],com,Y[i]))
                return false
        }
        return true
    }

    function hm(){
        let s = document.getElementById('missed').value;
        let registerLength = parseInt(document.getElementById('register').value)
        let permuts = generateBinary(registerLength)
        let matrix = []
        let Y = []
        for(let i = 0;i<registerLength;i++){
            Y.push(parseInt(s[i+registerLength]))
            matrix.push(s.slice(i,i+registerLength))
        }
        let ans;
        for(let i = 0 ;i< permuts.length;i++)
        {
            if(isRight(permuts[i],matrix,Y)){
                ans=permuts[i]
                break
            }
        }
        let res = '';
        for(let i = 0 ; i< ans.length;i++){
            res+=`x[${registerLength-i}]: ${ans[i]}\n`
        }
        document.getElementById('answer').innerText = 'Your answer is:\n\n'+ res

    }
    document.getElementById('btn').addEventListener('click',hm)

</script>
</body>
</html>
